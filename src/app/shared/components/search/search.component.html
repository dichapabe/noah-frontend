<!-- SEARCH CONTAINER -->
<div class="relative">
  <div class="pt-2">
    <div
      class="
        relative
        border-solid border-gray-400 border
        bg-white
        flex
        justify-center
        items-center
        rounded-full
        z-10
      "
    >
      <div class="pl-3">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="text-primary h-5 w-5"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            fill-rule="evenodd"
            d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
            clip-rule="evenodd"
          />
        </svg>
      </div>
      <input
        type="search"
        [formControl]="searchTermCtrl"
        (keyup)="isDropdownOpen = true"
        (focus)="isDropdownOpen = true"
        placeholder="Search location"
        autocomplete="off"
        class="
          rounded-l-full
          w-full
          py-2
          px-2
          text-gray-700
          leading-tight
          focus:outline-none
        "
      />
      <button
        type="submit"
        class="
          rounded-full
          bg-primary
          text-white
          p-2
          m-1
          w-auto
          h-auto
          hover:bg-blue-400
          focus:outline-none
          flex
          items-center
          justify-center
        "
      >
        <span class="w-auto flex justify-end items-center">
          <svg
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            viewBox="0 0 24 24"
            class="w-4 h-4"
          >
            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </span>
      </button>
    </div>
  </div>

  <!-- DROPDOWN -->
  <div
    class="
      z-40
      absolute
      mt-2
      py-2
      w-full
      bg-white
      shadow-xl
      rounded-md
      transition
      duration-300
      ease-in-out
    "
    *ngIf="isDropdownOpen && (places$ | async)?.length"
  >
    <ul class="list-none">
      <li
        class="
          block
          w-full
          px-4
          py-4
          font-bold
          text-sm
          cursor-pointer
          text-left text-gray-700
          hover:bg-gray-100 hover:text-gray-900
          transition
          duration-300
          ease-in-out
          focus:outline-none
          group
        "
      >
        <span>
          <svg
            class="w-6 pr-2 inline-block"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12 4.5V2.625"
              stroke="#0166FF"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M12 21.375V19.5"
              stroke="#0166FF"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M12 5.25C10.665 5.25 9.35994 5.64588 8.2499 6.38758C7.13987 7.12928 6.27471 8.18349 5.76382 9.41689C5.25292 10.6503 5.11925 12.0075 5.3797 13.3169C5.64015 14.6262 6.28303 15.829 7.22703 16.773C8.17104 17.717 9.37377 18.3599 10.6831 18.6203C11.9925 18.8808 13.3497 18.7471 14.5831 18.2362C15.8165 17.7253 16.8707 16.8601 17.6124 15.7501C18.3541 14.6401 18.75 13.335 18.75 12C18.75 10.2098 18.0388 8.4929 16.773 7.22703C15.5071 5.96116 13.7902 5.25 12 5.25Z"
              stroke="#0166FF"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M12 9C12.5933 9 13.1734 9.17595 13.6667 9.50559C14.1601 9.83524 14.5446 10.3038 14.7716 10.8519C14.9987 11.4001 15.0581 12.0033 14.9424 12.5853C14.8266 13.1672 14.5409 13.7018 14.1213 14.1213C13.7018 14.5409 13.1672 14.8266 12.5853 14.9424C12.0033 15.0581 11.4001 14.9987 10.8519 14.7716C10.3038 14.5446 9.83524 14.1601 9.50559 13.6667C9.17595 13.1734 9 12.5933 9 12C9 11.2043 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9Z"
              fill="#0166FF"
              stroke="#0166FF"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M19.5 12H21.375"
              stroke="#0166FF"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M2.625 12H4.5"
              stroke="#0166FF"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            /></svg
          >Your Current Location</span
        >
      </li>
      <li
        (click)="pickPlace(place)"
        *ngFor="let place of places$ | async"
        class="
          flex-row
          block
          w-full
          px-4
          py-0
          cursor-pointer
          text-left
          hover:bg-gray-100 hover:text-gray-900
          transition
          duration-300
          ease-in-out
          focus:outline-none
          group
          overflow:
          hidden;
          text-overflow:
          ellipsis;
          white-space:
          wrap;
        "
      >
        <div class="py-2 max-w-xl w-full flex flex-row">
          <div class="md:mt-0 items-center flex">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="inline-block pr-2 text-high h-8 w-6"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fill-rule="evenodd"
                d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                clip-rule="evenodd"
              />
            </svg>
          </div>
          <div class="flex-1">
            <p class="font-bold text-gray-700 text-sm">{{ place.text }}</p>
            <p class="text-xs text-gray-300 group-hover:text-gray-400">
              {{ place.place_name }}
            </p>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <!-- BACKDROP -->
  <div
    (click)="isDropdownOpen = false"
    *ngIf="isDropdownOpen"
    class="fixed h-full bg-black opacity-30 top-0 right-0 bottom-0 left-0"
  ></div>
</div>
